import{_ as o,c as a,o as i,ae as r}from"./chunks/framework.Dgg8-8ov.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"mediaSoup/jiaohu.md","filePath":"mediaSoup/jiaohu.md"}'),t={name:"mediaSoup/jiaohu.md"};function l(c,e,s,n,d,p){return i(),a("div",null,e[0]||(e[0]=[r('<h5 id="交互逻辑" tabindex="-1">交互逻辑： <a class="header-anchor" href="#交互逻辑" aria-label="Permalink to &quot;交互逻辑：&quot;">​</a></h5><h5 id="第一轮" tabindex="-1"><code>第一轮</code> <a class="header-anchor" href="#第一轮" aria-label="Permalink to &quot;`第一轮`&quot;">​</a></h5><p><strong>客户端</strong></p><ol><li>客户端新建 websocket 连接（url+roomId）</li><li>客户端设置监听 ws 消息</li></ol><p><strong>服务端</strong></p><blockquote><p>roomMap &gt; room &gt; member &gt; transportInfo</p></blockquote><ol><li>设置定时任务，每隔 5 秒检测发送服务器情况、检测服务器带宽是否充足</li><li>通过 roomMap 创建 worker 通道 (<code>mediaSoup.createWorker</code>)</li><li>work 调用 createWebRtcServer(<code>worker.createWebRtcServer</code>)</li><li>初始化 room 信息</li><li>初始化 websocket 连接，发送 authorization 消息</li><li>设置监听消息</li></ol><h5 id="第二轮" tabindex="-1"><code>第二轮</code> <a class="header-anchor" href="#第二轮" aria-label="Permalink to &quot;`第二轮`&quot;">​</a></h5><p><strong>客户端</strong></p><ol><li>客户端收到authorization消息，发送join 消息</li></ol><p><strong>服务端</strong></p><ol><li>服务端收到 join 消息，开始处理</li><li>room 中加入该成员，获取对应 router 的 rtpCapabilities（<code>router.rtpCapabilities</code>）</li><li>向客户端发送 join 消息，传递 rtpCapabilities</li><li>发送通知消息 notified</li></ol><h5 id="第三轮" tabindex="-1"><code>第三轮</code> <a class="header-anchor" href="#第三轮" aria-label="Permalink to &quot;`第三轮`&quot;">​</a></h5><p>客户端：</p><ol><li>收到 join 消息，拿到 rtpCapabilities，开始处理</li><li>客户端 load（<code>device.load({ routerRtpCapabilities })</code>）</li><li>给服务端发送 createTransport 消息</li></ol><p>服务端：</p><ol><li>收到 createTransport 消息，开始处理</li><li>调用 router.createWebRtcTransport，返回一个 <code>transport</code> 对象。</li><li>transport包含<code>id、iceParameters、iceCandidates、dtlsParameters、sctpParameters</code></li><li>创建 consume（<code>transport.consume</code>）</li><li>发送newConsumer消息，传递 consume 信息</li></ol>',17)]))}const h=o(t,[["render",l]]);export{m as __pageData,h as default};
